SELECT
  P.Name PROVINCE_NAME,
  V.Name VACCINE_NAME,
  COUNT(distinct VCN.patientID) TOTAL_NUMBER_VACCINATIONS_GIVEN
FROM
  Province P
  INNER JOIN Facility F ON F.provinceID = P.ID
  INNER JOIN Inventory I ON I.facilityID = F.ID
  INNER JOIN Vaccine V on V.ID = I.vaccineID
  INNER JOIN Vaccination VCN ON VCN.vaccineID = V.ID
WHERE
  dateGiven BETWEEN '2021-01-01' AND '2021-07-22'
GROUP BY PROVINCE_NAME, VACCINE_NAME
ORDER BY
	PROVINCE_NAME ASC, TOTAL_NUMBER_VACCINATIONS_GIVEN DESC
